{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/boxicons/2.1.4/css/boxicons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="{% static 'mentalhealth/img/favicon.png' %}">
    <meta name="csrf-token" content="{{ csrf_token }}">

    <title>Scheduler | CalmConnect</title>
    
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        /* Header Styles - Matching Admin Panel */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .hdr {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .hdr-logo h2 {
            color: #2ecc71;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .hdr-logo a {
            text-decoration: none;
        }

        .hdr-btns {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .prfl-bell {
            position: relative;
            cursor: pointer;
        }

        .prfl-bell i {
            font-size: 1.3rem;
            color: #666;
            transition: color 0.3s ease;
        }

        .prfl-bell:hover i {
            color: #2ecc71;
        }

        .prfl-name h4 {
            color: #333;
            font-weight: 600;
            text-transform: uppercase;
        }

        .prfl-container img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #2ecc71;
        }

        /* Dropdown Styles */
        .dropdown {
            position: relative;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1rem;
            min-width: 150px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1001;
        }

        .dropdown-menu a {
            display: block;
            padding: 0.5rem 0;
            color: #333;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .dropdown-menu a:hover {
            color: #2ecc71;
        }

        /* Main Content */
        .main-bdy {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Hero Section */
        .bdy-upper {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            text-align: center;
            padding: 3rem 2rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 15px 35px rgba(46, 204, 113, 0.3);
        }

        .upper-txt h2 {
            font-size: 2.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .upper-txt p {
            font-size: 1.2rem;
            font-weight: 400;
            opacity: 0.9;
        }

        /* Scheduler Container */
        .scheduler-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .scheduler-container h3 {
            text-align: center;
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 2rem;
        }

        /* Counselor Selection with Carousel */
        .counselor-selection-container {
            position: relative;
            margin: 2rem 0;
            overflow: hidden;
        }

        .counselor-selection {
            display: flex;
            gap: 2rem;
            transition: transform 0.5s ease;
            padding: 0 50px;
            scroll-behavior: smooth;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }

        .counselor-selection::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        .counselor-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            min-width: 250px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            flex: 0 0 auto;
            scroll-snap-align: center;
            opacity: 0.6;
            transform: scale(0.9);
        }

        .counselor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
        }

        .counselor-card.active {
            opacity: 1;
            transform: scale(1);
            background: rgba(46, 204, 113, 0.1);
            border: 2px solid #2ecc71;
        }

        .counselor-card:hover {
            transform: scale(0.95);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .counselor-card img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 1rem;
            border: 3px solid #2ecc71;
            transition: transform 0.3s ease;
        }

        .counselor-card:hover img {
            transform: scale(1.05);
        }

        .counselor-details .name {
            font-weight: 600;
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .counselor-details .unit,
        .counselor-details .rank {
            font-size: 0.9rem;
            color: #666;
        }

        /* Navigation Arrows */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .nav-arrow:hover {
            background: #2ecc71;
            color: white;
            transform: translateY(-50%) scale(1.1);
        }

        .nav-arrow.left {
            left: 0;
        }

        .nav-arrow.right {
            right: 0;
        }

        /* Pagination Dots */
        .pagination-dots {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            gap: 0.5rem;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active {
            background: #2ecc71;
            transform: scale(1.2);
        }

        /* Animation for card appearance */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .counselor-card {
            animation: fadeIn 0.5s ease forwards;
        }

        .counselor-card:nth-child(1) { animation-delay: 0.1s; }
        .counselor-card:nth-child(2) { animation-delay: 0.2s; }
        .counselor-card:nth-child(3) { animation-delay: 0.3s; }

        /* Available Slots */
        #available-slots {
            margin-top: 2rem;
            display: none;
        }

        #available-slots h4 {
            text-align: center;
            font-size: 1.4rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
        }

        .slot-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            list-style: none;
        }

        .slot-item {
            background: rgba(233, 249, 241, 0.9);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slot-item:hover {
            background: #2ecc71;
            color: white;
            transform: translateY(-3px);
        }

        .slot-item.selected {
            background: #2ecc71;
            color: white;
        }

        /* Session Type Selection */
        .session-type-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .session-type-option {
            cursor: pointer;
        }

        .session-type-option input[type="radio"] {
            display: none;
        }

        .session-type-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1.5rem;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
            text-align: center;
            height: 100%;
        }

        .session-type-card i {
            font-size: 3rem;
            color: #666;
            margin-bottom: 1rem;
            transition: color 0.3s ease;
        }

        .session-type-card h5 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .session-type-card p {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        .session-type-option input[type="radio"]:checked + .session-type-card {
            border-color: #2ecc71;
            background: rgba(46, 204, 113, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.2);
        }

        .session-type-option input[type="radio"]:checked + .session-type-card i {
            color: #2ecc71;
        }

        .session-type-card:hover {
            border-color: #2ecc71;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            width: 100%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .modal-content::-webkit-scrollbar {
            display: none;
        }

        .modal-content {
            scrollbar-width: none;
        }

        .close-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.8rem;
            font-size: 1.3rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
            z-index: 1;
        }

        .close-btn:hover {
            color: #2ecc71;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-header h3 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: #7f8c8d;
            font-size: 0.95rem;
        }

        .form-section {
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #ecf0f1;
        }

        .section-title {
            color: #2ecc71;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            display: block;
            width: 5px;
            height: 18px;
            background: #2ecc71;
            border-radius: 3px;
        }

        .form-row {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .form-group {
            flex: 1;
        }

        .input-field {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }

        .input-field:focus {
            border-color: #2ecc71;
            background: white;
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1);
        }

        .textarea-field {
            min-height: 100px;
            resize: vertical;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.8rem;
            margin-top: 1rem;
        }

        .service-option {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            padding: 0.8rem;
            border-radius: 8px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .service-option:hover {
            background: #e8f5e9;
        }

        .service-option input {
            display: none;
        }

        .checkmark {
            width: 18px;
            height: 18px;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .service-option input:checked ~ .checkmark {
            background: #2ecc71;
            border-color: #2ecc71;
        }

        .checkmark::after {
            content: '';
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .service-option input:checked ~ .checkmark::after {
            opacity: 1;
        }

        .service-label {
            font-size: 0.9rem;
            color: #34495e;
        }

        .consent-section {
            margin: 2rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .consent-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            cursor: pointer;
        }

        .consent-text {
            font-size: 0.85rem;
            color: #7f8c8d;
            line-height: 1.4;
        }

        .submit-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, #27ae60, #229954);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }

        /* Confirmation Modal */
        #confirmationModal {
            text-align: center;
        }

        #confirmationModal .modal-content {
            max-width: 300px;
        }

        #confirmationModal h3 {
            color: #2ecc71;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        #confirmationModal p {
            margin-bottom: 1rem;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        #confirmationModal button {
            padding: 0.6rem 1.2rem;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #confirmationModal button:hover {
            background: linear-gradient(135deg, #27ae60, #229954);
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hdr {
                padding: 1rem;
            }

            .main-bdy {
                padding: 1rem;
            }

            .bdy-upper {
                padding: 2rem 1rem;
            }

            .upper-txt h2 {
                font-size: 2rem;
            }

            .counselor-card {
                min-width: 220px;
            }

            .slot-list {
                grid-template-columns: 1fr;
            }

            .form-row {
                flex-direction: column;
                gap: 1rem;
            }
            
            .services-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                padding: 1.5rem;
                max-width: 95%;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 1rem;
            }

            .nav-arrow {
                width: 30px;
                height: 30px;
                font-size: 1rem;
            }

            .counselor-card {
                min-width: 200px;
            }
        }
        .has-dass-result {
    border-left: 4px solid #2ecc71;
    padding-left: 1rem;
}

.has-dass-result label {
    font-weight: 600;
    color: #2ecc71;
}
.loading-spinner {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Make loading modal background more transparent */
#loading-modal .modal-content {
    background: rgba(255, 255, 255, 0.2) !important;
    backdrop-filter: blur(10px);
}
.booking-modal-card {
    background: linear-gradient(135deg, #f8fffa 0%, #e9f7ef 100%);
    border-radius: 22px;
    box-shadow: 0 8px 32px rgba(46,204,113,0.13), 0 1.5px 6px rgba(46,204,113,0.08);
    padding: 2.5rem 2rem 2rem 2rem;
    max-width: 540px;
    margin: 0 auto;
    position: relative;
    animation: fadeIn 0.7s cubic-bezier(.4,0,.2,1);
}
.booking-modal-card .modal-header h3 {
    color: #229954;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.booking-modal-card .modal-header h3 i {
    color: #27ae60;
    font-size: 1.5em;
}
.booking-modal-card .modal-subtitle {
    color: #7f8c8d;
    font-size: 1.08rem;
    margin-bottom: 1.5rem;
}
.booking-modal-card .form-section {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 1.2rem 1rem 1rem 1rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(46,204,113,0.04);
}
.booking-modal-card .section-title {
    color: #229954;
    font-size: 1.13rem;
    margin-bottom: 1.1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.booking-modal-card .section-title i {
    color: #27ae60;
    font-size: 1.2em;
}
.booking-modal-card .input-field {
    background: #f4fef8;
    border: 1.5px solid #e0e0e0;
    border-radius: 8px;
    padding: 0.85rem 1.1rem 0.85rem 2.5rem;
    font-size: 1rem;
    transition: border-color 0.2s, box-shadow 0.2s;
    box-shadow: 0 1px 3px rgba(46,204,113,0.03);
    position: relative;
}
.booking-modal-card .input-field:focus {
    border-color: #27ae60;
    background: #fff;
    box-shadow: 0 0 0 3px rgba(46,204,113,0.09);
}
.booking-modal-card .input-icon {
    position: absolute;
    left: 1.1rem;
    top: 50%;
    transform: translateY(-50%);
    color: #b2dfdb;
    font-size: 1.15em;
    pointer-events: none;
}
.booking-modal-card .form-group {
    position: relative;
}
.booking-modal-card .service-option {
    background: #f4fef8;
    border: 1.5px solid #e0e0e0;
    border-radius: 8px;
    transition: border-color 0.2s, background 0.2s;
}
.booking-modal-card .service-option:hover,
.booking-modal-card .service-option input:checked ~ .checkmark {
    background: #e8f5e9;
    border-color: #27ae60;
}
.booking-modal-card .submit-btn {
    width: 100%;
    padding: 1.1rem;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.13rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.7rem;
    box-shadow: 0 2px 8px rgba(46,204,113,0.08);
    margin-top: 0.7rem;
}
.booking-modal-card .submit-btn:active {
    background: linear-gradient(135deg, #27ae60, #229954);
    transform: translateY(1px);
}
.booking-modal-card .submit-btn .spinner {
    width: 20px;
    height: 20px;
    border: 3px solid #e5e5e5;
    border-top: 3px solid #27ae60;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: inline-block;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
.booking-modal-card .consent-section {
    background: #f4fef8;
    border-radius: 8px;
    padding: 0.7rem 1rem;
    margin-bottom: 1.2rem;
    border: 1.5px solid #e0e0e0;
}
.booking-modal-card .consent-checkbox .checkmark {
    border-radius: 50%;
    border-width: 2.5px;
}
.booking-modal-card .consent-checkbox input:checked ~ .checkmark {
    background: #27ae60;
    border-color: #27ae60;
}
.booking-modal-card .consent-text {
    color: #229954;
    font-weight: 500;
}
.notification-dropdown {
    position: absolute;
    right: 0;
    top: 100%;
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 8px 32px rgba(46,204,113,0.13), 0 1.5px 6px rgba(46,204,113,0.08);
    padding: 1.1rem 0.7rem 0.7rem 0.7rem;
    min-width: 320px;
    max-width: 360px;
    max-height: 420px;
    overflow-y: auto;
    z-index: 2000;
    border: 1.5px solid #e9f7ef;
    animation: fadeIn 0.3s cubic-bezier(.4,0,.2,1);
}
.notification-item {
    display: block;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 0.7rem;
    padding: 0.85rem 1rem;
    color: #229954;
    text-decoration: none;
    transition: background 0.18s, box-shadow 0.18s;
    box-shadow: 0 1px 3px rgba(46,204,113,0.03);
}
.notification-item:hover {
    background: #e8f5e9;
    box-shadow: 0 2px 8px rgba(46,204,113,0.08);
}
.notification-badge {
    position: absolute;
    top: -7px;
    right: -7px;
    background: #e74c3c;
    color: #fff;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: bold;
    box-shadow: 0 2px 6px rgba(231,76,60,0.13);
    border: 2px solid #fff;
}
.ai-spinner {
    width: 22px;
    height: 22px;
    border: 3px solid #e5e5e5;
    border-top: 3px solid #27ae60;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: inline-block;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
    </style>
</head>
<body>
    <header>
        <div class="hdr">
            <div class="hdr-logo"><a href="{% url 'index' %}"><h2>CalmConnect</h2></a></div>
            <div class="hdr-btns">
                <div class="prfl-bell" id="notif-bell">
                    <i class="bx bxs-bell" id="bell-icon"></i>
                    <span class="notification-badge" id="notificationBadge" style="display:none;">0</span>
                    <div class="notification-dropdown" id="notificationDropdown" style="display:none;"></div>
                </div>
<div class="prfl-name">
    <h4>{{ user.username }}</h4>
</div>
<div class="prfl-container dropdown">
    <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'mentalhealth/img/default.jpg' %}{% endif %}" 
         alt="Profile Picture" 
         id="profile-img">
    <div class="dropdown-menu" id="profile-dropdown">
        <a href="#">Settings</a>
        <a href="{% url 'logout' %}">Log out</a>
        <a href="{% url 'user-profile' %}">Profile</a>
    </div>
</div>
            </div>
        </div>
    </header>

    <main class="main-bdy">
        <div class="bdy-upper">
            <div class="upper-txt">
                <h2>Counseling Scheduler</h2>
                <p>Book an appointment with our guidance counselors</p>
            </div>
        </div>
        <div class="scheduler-container">
            <h3>Select a Counselor</h3>
            <div class="counselor-selection-container">
                <div class="nav-arrow left" id="prev-counselor">❮</div>
                <div class="counselor-selection" id="counselor-carousel">
                    {% for counselor in counselors %}
                    <div class="counselor-card" data-counselor="{{ counselor.id }}">
                        <img src="{% if counselor.image %}{{ counselor.image.url }}{% else %}{% static 'mentalhealth/img/default.jpg' %}{% endif %}" alt="{{ counselor.name }}" />
                        <div class="counselor-details">
                            <p class="name">{{ counselor.name }}</p>
                            <p class="unit">{{ counselor.unit }}</p>
                            <p class="rank">{{ counselor.rank }}</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="nav-arrow right" id="next-counselor">❯</div>
                <div class="pagination-dots" id="pagination-dots"></div>
            </div>
            <div id="available-slots" style="display:none;">
                <h4>Available Slots</h4>
                <p style="text-align:center;color:#666;margin-bottom:0.5rem;">
                  <strong>Tip:</strong> Only available slots for the next 7 days are shown. Select a slot that best fits your schedule.
                </p>
                <p style="text-align:center;color:#888;font-size:0.95em;margin-bottom:1.5rem;">
                  If you don't see a suitable time, try checking back later or contact your counselor for more options.
                </p>
                <ul class="slot-list"></ul>
                <button id="book-btn" class="submit-btn" style="margin-top:1.5rem;display:none;"><i class='bx bx-calendar-check'></i> Book Selected Slot</button>
                <div id="slot-error" style="color:#e74c3c;text-align:center;margin-top:1rem;display:none;"></div>
            </div>
        </div>
    </main>
    <!-- Booking Modal -->
    <div id="booking-modal" class="modal">
        <div class="modal-content booking-modal-card">
            <span class="close-btn" id="close-modal">&times;</span>
            <div class="modal-header">
                <h3><i class='bx bx-calendar'></i> Book Your Counseling Session</h3>
                <p class="modal-subtitle">Complete the form to schedule your appointment</p>
            </div>
            <form id="booking-form">
                {% csrf_token %}
                <div class="form-section">
                    <h4 class="section-title"><i class='bx bx-info-circle'></i> Appointment Details</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Counselor</label>
                            <span class="input-icon"><i class='bx bx-user'></i></span>
                            <input type="text" id="counselor-display" class="input-field" readonly>
                        </div>
                        <div class="form-group">
                            <label>Appointment Slot</label>
                            <span class="input-icon"><i class='bx bx-time'></i></span>
                            <input type="text" name="slot" id="slot-display" class="input-field" readonly>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <h4 class="section-title"><i class='bx bx-user-circle'></i> Student Information</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course">Course/Year & Section</label>
                            <span class="input-icon"><i class='bx bx-book'></i></span>
                            <input type="text" name="course" id="course" class="input-field" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Cell phone Number</label>
                            <span class="input-icon"><i class='bx bx-phone'></i></span>
                            <input type="tel" name="phone" id="phone" class="input-field" required>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <h4 class="section-title"><i class='bx bx-video'></i> Session Type</h4>
                    <div class="session-type-selection">
                        <label class="session-type-option">
                            <input type="radio" name="session_type" value="face_to_face" checked>
                            <span class="session-type-card">
                                <i class='bx bx-user'></i>
                                <h5>Face-to-Face</h5>
                                <p>Traditional in-person counseling session at the counseling center</p>
                            </span>
                        </label>
                        <label class="session-type-option">
                            <input type="radio" name="session_type" value="remote">
                            <span class="session-type-card">
                                <i class='bx bx-video'></i>
                                <h5>Remote/Online</h5>
                                <p>Video call session from anywhere with internet connection</p>
                            </span>
                        </label>
                    </div>
                </div>
                <div class="form-section">
                    <h4 class="section-title"><i class='bx bx-help-circle'></i> Services Needed</h4>
                    <div class="services-grid">
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Counseling">
                            <span class="checkmark"></span>
                            <span class="service-label">Counseling</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Psychological Testing">
                            <span class="checkmark"></span>
                            <span class="service-label">Psychological Testing</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Consultation">
                            <span class="checkmark"></span>
                            <span class="service-label">Consultation</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Career Counseling">
                            <span class="checkmark"></span>
                            <span class="service-label">Career Counseling</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Learning Assistance">
                            <span class="checkmark"></span>
                            <span class="service-label">Learning Assistance</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Follow up">
                            <span class="checkmark"></span>
                            <span class="service-label">Follow up</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Orientation">
                            <span class="checkmark"></span>
                            <span class="service-label">Orientation</span>
                        </label>
                        <label class="service-option">
                            <input type="checkbox" name="service" value="Others">
                            <span class="checkmark"></span>
                            <span class="service-label">Others</span>
                        </label>
                    </div>
                </div>
                <div class="form-section">
                    <h4 class="section-title"><i class='bx bx-message-square-detail'></i> Additional Information</h4>
                    <div class="form-group">
                        <label for="reason">Reason for Visit/Other Services</label>
                        <span class="input-icon"><i class='bx bx-comment-detail'></i></span>
                        <textarea name="reason" id="reason" class="input-field textarea-field" rows="4" placeholder="Briefly describe your concern or specify other services..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>DASS21 Result (if applicable)</label>
                        <span class="input-icon"><i class='bx bx-bar-chart'></i></span>
                        <input type="text" name="dass" id="dass-result" class="input-field" value="{% if dass_result %}Depression: {{ dass_result.depression_score }}, Anxiety: {{ dass_result.anxiety_score }}, Stress: {{ dass_result.stress_score }}{% endif %}" readonly>
                    </div>
                </div>
                <div class="consent-section">
                    <label class="consent-checkbox">
                        <input type="checkbox" name="consent" required>
                        <span class="checkmark"></span>
                        <span class="consent-text">I confirm that the information provided is accurate and consent to the counseling process</span>
                    </label>
                </div>
                <div id="form-error" style="color:#e74c3c;text-align:center;margin-bottom:1rem;display:none;"></div>
                <button type="submit" class="submit-btn">
                    <span class="spinner" style="display:none;"></span>
                    <i class='bx bx-calendar-check'></i> Confirm Appointment
                </button>
            </form>
        </div>
    </div>
    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeConfirmationModal()">&times;</span>
            <h3> Appointment Confirmed!</h3>
            <p>Your session with the guidance counselor has been successfully booked.</p>
            <p>You'll receive further details via email or dashboard notification.</p>
            <button onclick="closeConfirmationModal()">Close</button>
        </div>
    </div>
    <div id="loading-modal" class="modal">
        <div class="modal-content" style="background: transparent; box-shadow: none;">
            <div style="text-align: center; color: white;">
                <div class="loading-spinner" style="font-size: 3rem; margin-bottom: 1rem;">
                    <i class='bx bx-loader-alt bx-spin'></i>
                </div>
                <h3>Processing your appointment...</h3>
                <p>Please wait while we confirm your booking</p>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>
    <script>
    // Carousel logic
    const carousel = document.getElementById('counselor-carousel');
    const cards = Array.from(document.querySelectorAll('.counselor-card'));
    const prevBtn = document.getElementById('prev-counselor');
    const nextBtn = document.getElementById('next-counselor');
    const dotsContainer = document.getElementById('pagination-dots');
    let currentIndex = 0;
    let selectedSlot = null;
    let selectedCounselorId = null;
    let selectedCounselorName = '';

    // DASS result from context
    const userDassResult = {% if dass_result %}{ id: {{ dass_result.id }}, depression_score: {{ dass_result.depression_score }}, anxiety_score: {{ dass_result.anxiety_score }}, stress_score: {{ dass_result.stress_score }} }{% else %}null{% endif %};

    // Create dots
    cards.forEach((_, index) => {
        const dot = document.createElement('div');
        dot.classList.add('dot');
        if (index === 0) dot.classList.add('active');
        dot.addEventListener('click', () => goToCard(index));
        dotsContainer.appendChild(dot);
    });

    function updateCards() {
        cards.forEach((card, index) => {
            card.classList.toggle('active', index === currentIndex);
            card.style.opacity = index === currentIndex ? '1' : '0.6';
            card.style.transform = index === currentIndex ? 'scale(1)' : 'scale(0.9)';
        });
        document.querySelectorAll('.dot').forEach((dot, index) => {
            dot.classList.toggle('active', index === currentIndex);
        });
        // Center active card
        const cardWidth = cards[0].offsetWidth + 32;
        carousel.scrollTo({
            left: currentIndex * cardWidth - (carousel.offsetWidth / 2 - cardWidth / 2),
            behavior: 'smooth'
        });
    }
    function goToCard(index) {
        currentIndex = index;
        updateCards();
        // Show slots for this counselor
        showSlotsForCounselor(cards[currentIndex]);
    }
    function nextCard() {
        currentIndex = (currentIndex + 1) % cards.length;
        updateCards();
        showSlotsForCounselor(cards[currentIndex]);
    }
    function prevCard() {
        currentIndex = (currentIndex - 1 + cards.length) % cards.length;
        updateCards();
        showSlotsForCounselor(cards[currentIndex]);
    }
    prevBtn.addEventListener('click', prevCard);
    nextBtn.addEventListener('click', nextCard);
    // Disable manual scroll
    carousel.addEventListener('wheel', e => e.preventDefault(), { passive: false });
    // Card click = select
    cards.forEach((card, index) => {
        card.addEventListener('click', () => goToCard(index));
    });
    // Show slots for selected counselor
    function showSlotsForCounselor(card) {
        selectedCounselorId = card.getAttribute('data-counselor');
        selectedCounselorName = card.querySelector('.name').textContent;
        document.getElementById('counselor-display').value = selectedCounselorName;
        const availableSlotsSection = document.getElementById('available-slots');
        availableSlotsSection.style.display = 'block';
        const slotList = document.querySelector('.slot-list');
        slotList.innerHTML = '<li style="text-align: center; padding: 2rem;">Loading available slots...</li>';
        document.getElementById('book-btn').style.display = 'none';
        document.getElementById('slot-error').style.display = 'none';
        selectedSlot = null;
        fetch(`/get-slots/${selectedCounselorId}/`)
            .then(response => response.json())
            .then(data => {
                slotList.innerHTML = '';
                if (data.success && data.slots.length > 0) {
                    data.slots.forEach(slot => {
                        const slotItem = document.createElement('li');
                        slotItem.className = 'slot-item';
                        slotItem.textContent = slot.display;
                        slotItem.setAttribute('data-date', slot.date);
                        slotItem.setAttribute('data-time', slot.time);
                        slotItem.tabIndex = 0;
                        slotItem.addEventListener('click', function() {
                            document.querySelectorAll('.slot-item').forEach(item => item.classList.remove('selected'));
                            this.classList.add('selected');
                            selectedSlot = {
                                display: this.textContent,
                                date: this.getAttribute('data-date'),
                                time: this.getAttribute('data-time')
                            };
                            document.getElementById('slot-display').value = selectedSlot.display;
                            document.getElementById('book-btn').style.display = 'block';
                        });
                        slotItem.addEventListener('keydown', function(e) {
                            if (e.key === 'Enter' || e.key === ' ') this.click();
                        });
                        slotList.appendChild(slotItem);
                    });
                } else {
                    slotList.innerHTML = '<li style="text-align: center; padding: 2rem;">No available slots at this time. Please check back later.</li>';
                }
            })
            .catch(error => {
                slotList.innerHTML = `<li style="text-align: center; padding: 2rem; color: #e74c3c;">Error: ${error.message}</li>`;
            });
    }
    // Book button logic
    document.getElementById('book-btn').addEventListener('click', function() {
        if (!selectedSlot) {
            document.getElementById('slot-error').textContent = 'Please select a slot.';
            document.getElementById('slot-error').style.display = 'block';
            return;
        }
        document.getElementById('slot-error').style.display = 'none';
        document.getElementById('booking-modal').style.display = 'flex';
        document.getElementById('slot-display').value = selectedSlot.display;
        document.getElementById('counselor-display').value = selectedCounselorName;
    });
    // Modal close logic
    function closeAllModals() {
        document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
    }
    document.getElementById('close-modal').addEventListener('click', closeAllModals);
    window.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeAllModals();
    });
    window.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) e.target.style.display = 'none';
    });
    // Dropdowns
    document.getElementById('profile-img').addEventListener('click', function(e) {
        e.stopPropagation();
        const dropdown = document.getElementById('profile-dropdown');
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });
    document.addEventListener('click', function() {
        document.getElementById('profile-dropdown').style.display = 'none';
    });
        // Unified notification dropdown logic
            function showNotificationDropdown() {
            console.log('showNotificationDropdown called (scheduler)');
            const dropdown = document.getElementById('notificationDropdown');
            if (!dropdown) {
                console.error('notificationDropdown element not found (scheduler)');
                return;
            }
            dropdown.innerHTML = '<div style="text-align:center;padding:1.5rem 0;"><span class="ai-spinner" style="width:22px;height:22px;"></span> Loading...</div>';
            dropdown.style.display = 'block';
            
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
            console.log('CSRF Token (scheduler):', csrfToken ? 'Present' : 'Missing');
            
            fetch('/notifications/', {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': csrfToken
                },
                credentials: 'same-origin'
            })
                .then(response => {
                    console.log('Notification response status (scheduler):', response.status);
                    if (!response.ok) {
                        if (response.status === 401) {
                            console.log('Unauthorized, redirecting to login (scheduler)');
                            window.location.href = '/login/';
                            return;
                        }
                        throw new Error(`HTTP ${response.status}`);
                    }
                    const contentType = response.headers.get('content-type');
                    console.log('Content-Type (scheduler):', contentType);
                    if (!contentType || !contentType.includes('application/json')) {
                        console.log('Invalid content type, redirecting to login (scheduler)');
                        window.location.href = '/login/';
                        return;
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Notification data (scheduler):', data);
                    dropdown.innerHTML = '';
                    if (data.notifications && data.notifications.length > 0) {
                        data.notifications.forEach(notif => {
                            const item = document.createElement('div');
                            item.className = 'notification-item';
                            item.style.cssText = 'display:flex;align-items:center;justify-content:space-between;padding:0.8rem;border-bottom:1px solid #eee;';
                            
                            const content = document.createElement('a');
                            content.href = notif.url;
                            content.style.cssText = 'flex:1;display:flex;align-items:center;gap:0.7rem;text-decoration:none;color:inherit;';
                            content.innerHTML = `
                                <i class='bx ${notif.type === 'appointment' ? 'bxs-calendar' : notif.type === 'report' ? 'bxs-report' : 'bxs-bell'}' style='color:#27ae60;font-size:1.2rem;'></i>
                                <span>${notif.message}</span>
                                <span style='margin-left:auto;font-size:0.85em;color:#888;'>${notif.time}</span>
                            `;
                            
                            const clearBtn = document.createElement('button');
                            clearBtn.innerHTML = '<i class="bx bx-x"></i>';
                            clearBtn.style.cssText = 'background:none;border:none;color:#e74c3c;cursor:pointer;padding:0.3rem;margin-left:0.5rem;font-size:1.1rem;';
                            clearBtn.title = 'Clear notification';
                            clearBtn.onclick = function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                clearNotification(notif.id);
                            };
                            
                            item.appendChild(content);
                            item.appendChild(clearBtn);
                            dropdown.appendChild(item);
                        });
                        
                        // Add clear all button
                        const clearAllDiv = document.createElement('div');
                        clearAllDiv.style.cssText = 'padding:0.8rem;border-top:2px solid #eee;text-align:center;';
                        
                        const clearAllBtn = document.createElement('button');
                        clearAllBtn.innerHTML = '<i class="bx bx-trash"></i> Clear All';
                        clearAllBtn.style.cssText = 'background:#e74c3c;color:white;border:none;padding:0.5rem 1rem;border-radius:4px;cursor:pointer;font-size:0.9rem;';
                        clearAllBtn.onclick = function(e) {
                            e.preventDefault();
                            if (confirm('Clear all notifications?')) {
                                clearAllNotifications();
                            }
                        };
                        
                        clearAllDiv.appendChild(clearAllBtn);
                        dropdown.appendChild(clearAllDiv);
                    } else {
                        dropdown.innerHTML = '<div style="text-align:center;padding:2rem 0;color:#888;"><i class="bx bxs-bell" style="font-size:2.2rem;"></i><br>No notifications</div>';
                    }
                })
                .catch((error) => {
                    console.error('Notification error (scheduler):', error);
                    dropdown.innerHTML = '<div style="text-align:center;padding:2rem 0;color:#e74c3c;">Error loading notifications</div>';
                });
    }
document.getElementById('bell-icon').addEventListener('click', function(e) {
    e.stopPropagation();
    const dropdown = document.getElementById('notificationDropdown');
    if (dropdown.style.display === 'block') {
        dropdown.style.display = 'none';
    } else {
        showNotificationDropdown();
    }
});
document.addEventListener('click', function() {
    document.getElementById('notificationDropdown').style.display = 'none';
});
// Badge update
        function updateNotificationBadge() {
            fetch('/notifications/', {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]')?.value || ''
                },
                credentials: 'same-origin'
            })
                .then(response => {
                    if (!response.ok) {
                        return;
                    }
                    const contentType = response.headers.get('content-type');
                    if (!contentType || !contentType.includes('application/json')) {
                        return;
                    }
                    return response.json();
                })
                .then(data => {
            const badge = document.getElementById('notificationBadge');
            if (data.count > 0) {
                badge.textContent = data.count;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        });
}
updateNotificationBadge();
setInterval(updateNotificationBadge, 300000);

// Function to clear individual notification
function clearNotification(notificationId) {
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
    
    fetch(`/notifications/${notificationId}/clear/`, {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrfToken
        },
        credentials: 'same-origin'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Refresh the notification dropdown
            showNotificationDropdown();
            // Update the badge
            updateNotificationBadge();
        } else {
            console.error('Error clearing notification:', data.error);
        }
    })
    .catch(error => {
        console.error('Error clearing notification:', error);
    });
}

// Function to clear all notifications
function clearAllNotifications() {
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
    
    fetch('/notifications/clear-all/', {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrfToken
        },
        credentials: 'same-origin'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Refresh the notification dropdown
            showNotificationDropdown();
            // Update the badge
            updateNotificationBadge();
        } else {
            console.error('Error clearing all notifications:', data.error);
        }
    })
    .catch(error => {
        console.error('Error clearing all notifications:', error);
    });
}
    // Booking form submit
    document.getElementById('booking-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formError = document.getElementById('form-error');
        formError.style.display = 'none';
        // Show loading modal
        const loadingModal = document.getElementById('loading-modal');
        loadingModal.style.display = 'flex';
        // Disable submit button
        const submitBtn = document.querySelector('#booking-form button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="bx bx-loader-alt bx-spin"></i> Processing...';
        try {
            const formData = {
                counselor_id: selectedCounselorId,
                date: selectedSlot?.date || '',
                time: selectedSlot?.time || '',
                session_type: document.querySelector('input[name="session_type"]:checked').value,
                services: Array.from(document.querySelectorAll('input[name="service"]:checked')).map(cb => cb.value),
                reason: document.getElementById('reason').value,
                phone: document.getElementById('phone').value,
                course_section: document.getElementById('course').value,
                dass_result_id: userDassResult ? userDassResult.id : null
            };
            if (!formData.counselor_id || !formData.date || !formData.time || !formData.services.length || !formData.reason || !formData.phone || !formData.course_section) {
                throw new Error('Please fill in all required fields and select a slot.');
            }
            const response = await fetch('/book-appointment/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify(formData)
            });
            const data = await response.json();
            loadingModal.style.display = 'none';
            if (!response.ok || !data.success) {
                throw new Error(data.error || 'Failed to book appointment');
            }
            closeAllModals();
            
            // Show different confirmation messages based on session type
            const confirmationModal = document.getElementById('confirmationModal');
            const confirmationTitle = confirmationModal.querySelector('h3');
            const confirmationMessage = confirmationModal.querySelector('p');
            
            if (data.session_type === 'remote') {
                confirmationTitle.innerHTML = '🎥 Remote Session Confirmed!';
                confirmationMessage.innerHTML = `
                    Your video counseling session has been successfully booked.<br>
                    You'll receive an email with your secure video call link.<br>
                    <strong>Please check your email for the video call details.</strong>
                `;
            } else {
                confirmationTitle.innerHTML = '✅ Face-to-Face Session Confirmed!';
                confirmationMessage.innerHTML = `
                    Your in-person counseling session has been successfully booked.<br>
                    Please arrive 5-10 minutes before your scheduled time.<br>
                    <strong>Location: University Counseling Center</strong>
                `;
            }
            
            confirmationModal.style.display = 'flex';
        } catch (error) {
            loadingModal.style.display = 'none';
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="bx bx-calendar-check"></i> Confirm Appointment';
            formError.textContent = error.message || 'An error occurred while booking your appointment';
            formError.style.display = 'block';
        }
    });
    // Confirmation modal close
    function closeConfirmationModal() {
        document.getElementById('confirmationModal').style.display = 'none';
        document.getElementById('booking-form').reset();
        selectedSlot = null;
        document.getElementById('available-slots').style.display = 'none';
        cards.forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.slot-item').forEach(item => item.classList.remove('selected'));
        document.getElementById('book-btn').style.display = 'none';
    }
    // Initial load: show first counselor's slots
    if (cards.length > 0) {
        goToCard(0);
    }
    // Add spinner logic to submit button
    const bookingForm = document.getElementById('booking-form');
    const submitBtn = bookingForm.querySelector('.submit-btn');
    const spinner = submitBtn.querySelector('.spinner');
    bookingForm.addEventListener('submit', function(e) {
        spinner.style.display = 'inline-block';
        submitBtn.setAttribute('disabled', 'disabled');
        submitBtn.style.opacity = '0.7';
    });
    </script>
</body>
</html>